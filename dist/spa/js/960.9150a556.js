(self["webpackChunkhumbleshit_app"]=self["webpackChunkhumbleshit_app"]||[]).push([[960],{6960:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Z});var i=a(3673),s=a(2323);const n={class:"text-center text-grey"},o=(0,i.Wm)("br",null,null,-1),r=(0,i.Uk)(" No facilities to check. "),c=(0,i.Wm)("br",null,null,-1),l=(0,i.Uk)(" Please start a shift to continue. "),u=(0,i.Wm)("span",{class:"q-mx-sm"},"Scan",-1);function d(e,t,a,d,h,m){const p=(0,i.up)("q-icon"),f=(0,i.up)("q-item-section"),g=(0,i.up)("q-item-label"),k=(0,i.up)("q-item"),w=(0,i.up)("q-list"),S=(0,i.up)("q-card-section"),y=(0,i.up)("q-card"),v=(0,i.up)("q-btn"),W=(0,i.up)("q-page-sticky"),_=(0,i.up)("q-spinner-gears"),q=(0,i.up)("q-inner-loading"),b=(0,i.up)("qrcode-stream"),Q=(0,i.up)("q-dialog"),C=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(C,{padding:""},{default:(0,i.w5)((()=>[m.userActiveShift&&"started"==m.userActiveShift.status&&m.facilities.length?((0,i.wg)(),(0,i.j4)(w,{key:0,bordered:"",separator:"",class:"bg-white rounded-borders"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(m.facilities,(t=>((0,i.wg)(),(0,i.j4)(k,{key:t._id,clickable:""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{avatar:""},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{name:"done"===t.checkStatus?"eva-checkmark-circle-outline":"doing"===t.checkStatus?"eva-clock-outline":"eva-close-circle-outline",color:"done"===t.checkStatus?"positive":"doing"===t.checkStatus?"warning":"negative"},null,8,["name","color"])])),_:2},1024),(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.name),1)])),_:2},1024),(0,i.Wm)(g,{caption:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.$filters.humanDateTime(t.lastChecked)),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(f,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{name:"eva-chevron-right-outline"})])),_:1})])),_:2},1024)))),128))])),_:1})):((0,i.wg)(),(0,i.j4)(y,{key:1,flat:"",bordered:""},{default:(0,i.w5)((()=>[(0,i.Wm)(S,null,{default:(0,i.w5)((()=>[(0,i.Wm)("div",n,[(0,i.Wm)(p,{name:"eva-checkmark-circle-outline",size:"lg",class:"q-mb-md"}),o,r,c,l])])),_:1})])),_:1})),(0,i.Wm)(W,{position:"bottom-right",offset:[18,18]},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{fab:"",icon:"eva-sun-outline",color:"primary","no-caps":"",onClick:m.startScan},{default:(0,i.w5)((()=>[u])),_:1},8,["onClick"])])),_:1}),(0,i.Wm)(Q,{modelValue:h.showScanner,"onUpdate:modelValue":t[1]||(t[1]=e=>h.showScanner=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(q,{showing:h.loading},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{size:"50px",color:"primary"})])),_:1},8,["showing"]),(0,i.Wm)(b,{onDecode:m.onDecode,onInit:m.onInit},null,8,["onDecode","onInit"])])),_:1})])),_:1},8,["modelValue"])])),_:1})}var h=a(4626);const m={name:"PageReportFacilities",components:{QrcodeStream:h.QrcodeStream},data(){return{showScanner:!1,errorMessage:null,loading:!1}},computed:{facilities(){return this.$store.getters["reports/facilities"]},userActiveShift(){return this.$store.getters["auth/userActiveShift"]},facilityIds(){return this.facilities.map((e=>e._id))}},mounted(){this.$store.dispatch("general/setTitle","Check Facilities"),this.fetchShiftState()},methods:{fetchShiftState(){this.$store.dispatch("reports/fetchShiftState")},startCheckup(e){e.checkStatus&&"todo"!=e.checkStatus?this.$q.notify({message:"This facility does not need checkup.",type:"warning"}):(this.$store.dispatch("reports/startCheckup",e._id),this.$router.push("/reports/checklist"))},startScan(){this.showScanner=!0},onDecode(e){this.showScanner=!1;let t=e.split("facility=")[1],a=this.facilityIds.indexOf(t);-1!=a?this.startCheckup(this.facilities[a]):this.$q.notify({message:"No such facility.",type:"negative"})},onInit(e){this.loading=!0,e.then((()=>{console.log("Successfully initilized! Ready for scanning now!"),this.loading=!1,this.$forceUpdate()})).catch((e=>{"NotAllowedError"===e.name?this.errorMessage="Hey! I need access to your camera":"NotFoundError"===e.name?this.errorMessage="Do you even have a camera on your device?":"NotSupportedError"===e.name?this.errorMessage="Seems like this page is served in non-secure context (HTTPS, localhost or file://)":"NotReadableError"===e.name?this.errorMessage="Couldn't access your camera. Is it already in use?":"OverconstrainedError"===e.name?this.errorMessage="Constraints don't match any installed camera. Did you asked for the front camera although there is none?":this.errorMessage="UNKNOWN ERROR: "+e.message,this.loading=!1,this.$q.notify({message:this.errorMessage,type:"negative"})}))}}};var p=a(4379),f=a(7011),g=a(6332),k=a(2035),w=a(4554),S=a(2350),y=a(151),v=a(5589),W=a(1007),_=a(8240),q=a(4390),b=a(6941),Q=a(6394),C=a(7518),I=a.n(C);m.render=d;const Z=m;I()(m,"components",{QPage:p.Z,QList:f.Z,QItem:g.Z,QItemSection:k.Z,QIcon:w.Z,QItemLabel:S.Z,QCard:y.Z,QCardSection:v.Z,QPageSticky:W.Z,QBtn:_.Z,QDialog:q.Z,QInnerLoading:b.Z,QSpinnerGears:Q.Z})}}]);