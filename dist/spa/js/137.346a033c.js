(self["webpackChunkhumbleshit_app"]=self["webpackChunkhumbleshit_app"]||[]).push([[137],{4137:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});a(246);var i=a(3673),l=a(2323);const s={class:"text-h6"},o=(0,i.Uk)(" Janitor Description "),n={class:"text-caption"},c=(0,i.Uk)(" Manager Description "),r={class:"text-caption"},d={class:"q-gutter-xs"},u={class:"col-6"},m={class:"col-6"};function p(e,t,a,p,h,g){const w=(0,i.up)("q-card-section"),k=(0,i.up)("q-separator"),f=(0,i.up)("q-item-label"),q=(0,i.up)("q-item-section"),W=(0,i.up)("q-btn"),_=(0,i.up)("q-item"),b=(0,i.up)("q-icon"),v=(0,i.up)("q-img"),y=(0,i.up)("q-avatar"),D=(0,i.up)("q-card-actions"),C=(0,i.up)("q-card"),Q=(0,i.up)("q-expansion-item"),Z=(0,i.up)("q-list"),$=(0,i.up)("q-dialog"),I=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(I,{padding:""},{default:(0,i.w5)((()=>[(0,i.Wm)(C,{flat:"",bordered:""},{default:(0,i.w5)((()=>[(0,i.Wm)(w,null,{default:(0,i.w5)((()=>[(0,i.Wm)("div",s,(0,l.zw)(h.parameterData.name),1)])),_:1}),(0,i.Wm)(k),(0,i.Wm)(Z,{separator:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(h.issues,(t=>((0,i.wg)(),(0,i.j4)(Q,{key:t._id,icon:t.statusAcknowledged?"":"eva-email-outline",label:t.ticket.facility.name,caption:e.$filters.formatDate(t.ticket.dateSubmitted),onShow:e=>g.acknowledgeIssue(t)},{default:(0,i.w5)((()=>[(0,i.Wm)(C,null,{default:(0,i.w5)((()=>[(0,i.Wm)(w,null,{default:(0,i.w5)((()=>[o,(0,i.Wm)("div",n,(0,l.zw)(t.description),1)])),_:2},1024),(0,i.Wm)(_,null,{default:(0,i.w5)((()=>[(0,i.Wm)(q,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.ticket.raisedBy.name),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(q,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{type:"a",href:`tel:${t.ticket.phone}`,color:"primary",flat:"",round:"",icon:"eva-phone-outline"},null,8,["href"])])),_:2},1024)])),_:2},1024),t.escalateDescription?((0,i.wg)(),(0,i.j4)(w,{key:0},{default:(0,i.w5)((()=>[c,(0,i.Wm)("div",r,(0,l.zw)(t.escalateDescription),1)])),_:2},1024)):(0,i.ry)("",!0),t.media.length?((0,i.wg)(),(0,i.j4)(w,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)("div",d,[((0,i.wg)(!0),(0,i.j4)(i.HY,null,(0,i.Ko)(t.media,((e,t)=>((0,i.wg)(),(0,i.j4)(y,{key:t,size:"32px",class:"col",rounded:"",onClick:t=>g.showImage(e.path)},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{ratio:1,basic:"",src:e.path},{error:(0,i.w5)((()=>[(0,i.Wm)(b,{name:"warning",color:"warning"})])),_:2},1032,["src"])])),_:2},1032,["onClick"])))),128))])])),_:2},1024)):(0,i.ry)("",!0),(0,i.Wm)(D,{class:"q-col-gutter-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)("div",u,[(0,i.Wm)(W,{rounded:"",outline:!g.canEscalate,class:"full-width",color:g.canEscalate?"negative":"grey",label:"ESCALATE",icon:"forward",disable:!g.canEscalate,onClick:e=>g.escalate(t)},null,8,["outline","color","disable","onClick"])]),(0,i.Wm)("div",m,[(0,i.Wm)(W,{rounded:"",class:"full-width",color:"positive",label:"CLOSE",icon:"check",onClick:e=>g.close(t)},null,8,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:2},1032,["icon","label","caption","onShow"])))),128))])),_:1})])),_:1}),(0,i.Wm)($,{modelValue:h.imageDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>h.imageDialog=e),position:"bottom"},{default:(0,i.w5)((()=>[(0,i.Wm)(C,null,{default:(0,i.w5)((()=>[(0,i.Wm)(v,{src:h.enlargedImage},null,8,["src"])])),_:1})])),_:1},8,["modelValue"])])),_:1})}a(9544);var h=a(5474);const g={data(){return{slide:1,parameter:null,issues:[],parameterData:{name:null},imageDialog:!1,enlargedImage:null,description:null}},computed:{canEscalate(){return!!this.user.reportsTo},user(){return this.$store.getters["auth/user"]}},mounted(){this.$store.dispatch("general/setTitle","Ticket Details"),this.parameter=this.$route.params.id,this.fetchTickets()},methods:{acknowledgeIssue(e){e.statusAcknowledged||(this.$q.loading.show(),h.api.put("/tickets/acknowledge",{issues:[e._id]}).then((e=>{this.fetchTickets()})).catch((e=>console.error(e))).finally((()=>{this.$q.loading.hide()})))},escalate(e){this.$q.dialog({title:"Enter Description",prompt:{model:"",type:"text"},ok:!0,cancel:!0}).onOk((t=>{console.log(t),this.$q.loading.show(),h.api.put("/tickets/escalate",{issues:[e._id],description:t}).then((e=>{this.fetchTickets()})).catch((e=>console.error(e))).finally((()=>{this.$q.loading.hide()}))}))},close(e){this.$q.dialog({title:"Confirm",message:"Do you want to Close the Ticket?",ok:!0,cancel:!0}).onOk((()=>{this.$q.loading.show(),h.api.put("/tickets/resolve",{issues:[e._id]}).then((e=>{this.fetchTickets()})).catch((e=>console.error(e))).finally((()=>{this.$q.loading.hide()}))}))},fetchTickets(){this.$q.loading.show(),h.api.get(process.env.API+"/tickets/unresolved/by-parameter?parameter="+this.parameter).then((e=>{this.issues=e.data.issues,this.parameterData=e.data.parameter})).catch((e=>console.error(e))).finally((()=>{this.$q.loading.hide()}))},showImage(e){this.enlargedImage=e,this.imageDialog=!0}}};var w=a(4379),k=a(151),f=a(5589),q=a(5869),W=a(7011),_=a(4615),b=a(6332),v=a(2035),y=a(2350),D=a(8240),C=a(5096),Q=a(4027),Z=a(4554),$=a(9367),I=a(4390),T=a(7518),E=a.n(T);g.render=p;const x=g;E()(g,"components",{QPage:w.Z,QCard:k.Z,QCardSection:f.Z,QSeparator:q.Z,QList:W.Z,QExpansionItem:_.Z,QItem:b.Z,QItemSection:v.Z,QItemLabel:y.Z,QBtn:D.Z,QAvatar:C.Z,QImg:Q.Z,QIcon:Z.Z,QCardActions:$.Z,QDialog:I.Z})}}]);