(self["webpackChunkhumbleshit_app"]=self["webpackChunkhumbleshit_app"]||[]).push([[75],{7330:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});a(71);var l=a(3673);function s(e,t,a,s,o,i){const n=(0,l.up)("q-icon"),r=(0,l.up)("q-spinner"),u=(0,l.up)("q-btn"),d=(0,l.up)("q-input");return(0,l.wg)(),(0,l.j4)(l.HY,null,[(0,l.Wm)(d,{modelValue:e.filePath,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filePath=t),outlined:"",color:"primary",label:e.label,class:"q-mb-md"},{prepend:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"insert_photo"})])),append:(0,l.w5)((()=>[e.fileProgress?((0,l.wg)(),(0,l.j4)(r,{key:0})):((0,l.wg)(),(0,l.j4)(u,{key:1,round:"",dense:"",color:"primary",icon:"attach_file",onClick:e.triggerFileInput},null,8,["onClick"]))])),_:1},8,["modelValue","label"]),(0,l.Wm)("input",{id:"image-file",class:"hidden",type:"file",onInput:t[2]||(t[2]=(...t)=>e.handleInput&&e.handleInput(...t))},null,32)],64)}a(9544);var o=a(1959),i=a(5474);const n=(0,l.aZ)({name:"RInputFile",props:{label:{type:String,default:"File URL"},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){let a=(0,o.iH)(null),s=(0,o.iH)(""),n=(0,o.iH)(!1);const r=()=>{document.getElementById("image-file").click()};(0,l.bv)((()=>{s.value=e.modelValue}));const u=e=>{n.value=!0;let a=new FormData;a.append("media",e),i.api.post(process.env.API+"/uploads",a,{headers:{"content-type":"multipart/form-data"}}).then((e=>{s.value=e.data[0].path,t("update:modelValue",s)})).catch((e=>console.error(e))).finally((()=>{n.value=!1}))},d=e=>{let t=e.target.files.length?e.target.files[0]:null;console.log(e),t&&u(t)};return{inputFile:a,fileProgress:n,filePath:s,triggerFileInput:r,handleInput:d}}});var r=a(4842),u=a(4554),d=a(6833),p=a(8240),m=a(7518),f=a.n(m);n.render=s;const c=n;f()(n,"components",{QInput:r.Z,QIcon:u.Z,QSpinner:d.Z,QBtn:p.Z})},75:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>K});var l=a(3673);function s(e,t,a,s,o,i){const n=(0,l.up)("q-tab"),r=(0,l.up)("q-tabs"),u=(0,l.up)("q-separator"),d=(0,l.up)("StaffList"),p=(0,l.up)("q-tab-panel"),m=(0,l.up)("q-tab-panels"),f=(0,l.up)("q-card"),c=(0,l.up)("q-btn"),h=(0,l.up)("q-page-sticky"),g=(0,l.up)("StaffForm"),w=(0,l.up)("q-dialog"),b=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(b,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{bordered:"",flat:"",class:"rounded-borders"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:o.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>o.tab=e),"active-color":"primary","narrow-indicator":""},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"reportees",label:"Reportees"}),(0,l.Wm)(n,{name:"all",label:"All"})])),_:1},8,["modelValue"]),(0,l.Wm)(u),(0,l.Wm)(m,{modelValue:o.tab,"onUpdate:modelValue":t[2]||(t[2]=e=>o.tab=e),swipeable:"",animated:""},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{name:"reportees",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{stafflist:i.reporteeStaffList},null,8,["stafflist"])])),_:1}),(0,l.Wm)(p,{name:"all",class:"q-pa-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{stafflist:i.allStaffList},null,8,["stafflist"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(h,{position:"bottom-right",offset:[18,18],class:"btn"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{fab:"",icon:"eva-person-add-outline",color:"primary",onClick:i.showAddStaffDialog},null,8,["onClick"])])),_:1}),(0,l.Wm)(w,{modelValue:o.addStaffDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>o.addStaffDialog=e),maximized:""},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{onDone:i.doneAddingStaff},null,8,["onDone"])])),_:1},8,["modelValue"])])),_:1})}var o=a(2323),i=a(8880);function n(e,t,a,s,n,r){const u=(0,l.up)("q-img"),d=(0,l.up)("q-avatar"),p=(0,l.up)("q-item-section"),m=(0,l.up)("q-item-label"),f=(0,l.up)("q-icon"),c=(0,l.up)("q-item"),h=(0,l.up)("q-list"),g=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)(h,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(a.stafflist,(e=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(c,{key:e._id,clickable:"",to:"/staff/"+e._id},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{color:"grey-3"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{src:e.img},null,8,["src"])])),_:2},1024)])),_:2},1024),(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.name),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(p,{side:""},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(f,{name:"brightness_1",color:"negative"},null,512),[[i.F8,"unavailable"==e.status]]),(0,l.wy)((0,l.Wm)(f,{name:"brightness_1",color:"warning"},null,512),[[i.F8,"busy"==e.status]]),(0,l.wy)((0,l.Wm)(f,{name:"brightness_1",color:"positive"},null,512),[[i.F8,"available"==e.status]])])),_:2},1024)])),_:2},1032,["to"])),[[g]]))),128))])),_:1})}const r={props:{stafflist:{type:Array,default:()=>[]}}};var u=a(7011),d=a(6332),p=a(2035),m=a(5096),f=a(4027),c=a(2350),h=a(4554),g=a(6489),w=a(7518),b=a.n(w);r.render=n;const W=r;b()(r,"components",{QList:u.Z,QItem:d.Z,QItemSection:p.Z,QAvatar:m.Z,QImg:f.Z,QItemLabel:c.Z,QIcon:h.Z}),b()(r,"directives",{Ripple:g.Z});const y={class:"text-h6"},q=(0,l.Uk)(" Add Staff "),v=(0,l.Uk)("Permissions "),S={class:"row q-col-gutter-md items-center"},Z={class:"col"};function _(e,t,a,s,i,n){const r=(0,l.up)("q-btn"),u=(0,l.up)("q-card-section"),d=(0,l.up)("q-input"),p=(0,l.up)("r-input-file"),m=(0,l.up)("q-select"),f=(0,l.up)("q-form"),c=(0,l.up)("q-item-label"),h=(0,l.up)("q-checkbox"),g=(0,l.up)("q-item-section"),w=(0,l.up)("q-item"),b=(0,l.up)("q-list"),W=(0,l.up)("q-card"),_=(0,l.Q2)("close-popup"),Q=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",y,[q,(0,l.wy)((0,l.Wm)(r,{round:"",flat:"",dense:"",icon:"eva-close-outline",class:"float-right"},null,512),[[_]])])])),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:i.staffDetails.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.staffDetails.name=e),outlined:"",label:"Name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),(0,l.Wm)(p,{modelValue:i.staffDetails.img,"onUpdate:modelValue":t[2]||(t[2]=e=>i.staffDetails.img=e),label:"Image"},null,8,["modelValue"]),(0,l.Wm)(d,{modelValue:i.staffDetails.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>i.staffDetails.phone=e),outlined:"",label:"Phone","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Please type your phone number"],prefix:"+91"},null,8,["modelValue","rules"]),(0,l.Wm)(d,{modelValue:i.staffDetails.password,"onUpdate:modelValue":t[4]||(t[4]=e=>i.staffDetails.password=e),outlined:"",label:"Password","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),(0,l.Wm)(m,{modelValue:i.staffDetails.reportsTo,"onUpdate:modelValue":t[5]||(t[5]=e=>i.staffDetails.reportsTo=e),outlined:"",label:"Reports To",options:i.supervisorOptions,"emit-value":"","map-options":""},null,8,["modelValue","options"])])),_:1}),(0,l.Wm)(b,{bordered:"",class:"q-mt-md rounded-borders"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{header:""},{default:(0,l.w5)((()=>[v])),_:1}),((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(i.permissions,(e=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(w,{key:e,tag:"label",dense:""},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{modelValue:i.staffDetails.permissions[e],"onUpdate:modelValue":t=>i.staffDetails.permissions[e]=t,val:"teal",color:"teal"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[Q]]))),128))])),_:1})])),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)("div",S,[(0,l.Wm)("div",Z,[(0,l.Wm)(r,{class:"full-width",rounded:"",label:"Save",type:"submit",color:"primary",onClick:n.addStaff},null,8,["onClick"])])])])),_:1})])),_:1})}a(9544);var Q=a(5474),V=a(7330);const k={components:{RInputFile:V.Z},emits:["done"],data(){return{staffDetails:{name:null,password:null,phone:null,reportsTo:null,img:null,permissions:{userRead:!1,userWrite:!1,facilityRead:!0,facilityWrite:!1,parameterRead:!0,parameterWrite:!1,reportRead:!0,reportWrite:!1,ticketRead:!1,ticketWrite:!1,staffRead:!0,staffWrite:!1,shiftRead:!0,shiftWrite:!1,statisticsRead:!1}},tempimage:null,supervisorOptions:[],permissions:["userRead","userWrite","facilityRead","facilityWrite","parameterRead","parameterWrite","reportRead","reportWrite","ticketRead","ticketWrite","staffRead","staffWrite","shiftRead","shiftWrite","statisticsRead"]}},computed:{loggedUser(){return this.$store.getters["auth/user"]}},mounted(){this.getSupervisors()},methods:{addStaff(){this.staffDetails.organization=this.loggedUser.organization,this.$q.loading.show(),Q.api.post("/users/create",this.staffDetails).then((e=>{this.$emit("done")})).catch((e=>{console.error(e),409==e.response.status&&this.$q.notify({type:"negative",message:"Phone number already exists."})})).finally((()=>{this.$q.loading.hide()}))},uploadImage(){this.$q.loading.show();var e=new FormData;e.append("media",this.tempimage),Q.api.post("/uploads",e,{headers:{"content-type":"multipart/form-data"}}).then((e=>{this.staffDetails.img=e.data[0].path})).catch((e=>console.error(e))).finally((()=>{this.$q.loading.hide()}))},getSupervisors(){Q.api.get("/users/staff").then((e=>{this.supervisorOptions=e.data.map((e=>({value:e._id,label:e.name})))})).catch((e=>{console.error(e)})).finally((()=>{this.$q.loading.hide()}))}}};var D=a(151),R=a(5589),I=a(8240),P=a(5269),U=a(4842),F=a(7727),C=a(5735),$=a(677);k.render=_;const L=k;b()(k,"components",{QCard:D.Z,QCardSection:R.Z,QBtn:I.Z,QForm:P.Z,QInput:U.Z,QSelect:F.Z,QList:u.Z,QItemLabel:c.Z,QItem:d.Z,QItemSection:p.Z,QCheckbox:C.Z}),b()(k,"directives",{ClosePopup:$.Z,Ripple:g.Z});const j={components:{StaffList:W,StaffForm:L},data(){return{tab:"reportees",addStaffDialog:!1}},computed:{allStaffList(){return this.$store.getters["users/allStaff"]},reporteeStaffList(){return this.$store.getters["users/reporteeStaff"]}},mounted(){this.$store.dispatch("general/setTitle","Staff"),this.getStaff()},methods:{getStaff(){this.$store.dispatch("users/fetchAllStaff"),this.$store.dispatch("users/fetchReporteeStaff")},showAddStaffDialog(){this.addStaffDialog=!0},doneAddingStaff(){this.addStaffDialog=!1,this.getStaff()}}};var A=a(4379),T=a(7547),z=a(8408),x=a(5869),H=a(5906),B=a(6602),O=a(1007),Y=a(4390);j.render=s;const K=j;b()(j,"components",{QPage:A.Z,QCard:D.Z,QTabs:T.Z,QTab:z.Z,QSeparator:x.Z,QTabPanels:H.Z,QTabPanel:B.Z,QPageSticky:O.Z,QBtn:I.Z,QDialog:Y.Z})}}]);